pipeline {
    agent any
    tools {
        maven "Maven"
        jdk 'JAVA_HOME'
    }
    
     parameters {
        choice(name: "Pruebas", choices: ["Todos", "Consulta de Registro de Empresa","Emitir Documentos","Generar Formulario Electronico", "Portal Pagos DNPs","Cert. de Bandeja de Entrada"],description: "Nombre de pruebas definidas para ejecutar")
        choice(name: "Baseline", choices: ["true", "false"],description: "Sacar nueva baseline?")
    }
    
    
    stages {
    
        stage('Ejecutar pruebas') {
                parallel
            {   
            	stage("Run Tests - Todos") 
                {
                    when { expression { params.Pruebas == "Todos" } }
                    steps 
                    {
                        script 
                        {
                            bat "mvn test -DsuiteXmlFiles=testng.xml -DnewBase=${Baseline}"
                        }
                        
                    }
                }
                
                stage("Run Tests - Consulta de Registro de Empresa") 
                {
                    when { expression { params.Pruebas == "Consulta de Registro de Empresa" } }
                    steps 
                    {
                        script 
                        {
                          
                           bat "mvn test -DsuiteXmlFiles=SuiteConsultaRegistroEmpresa.xml -DnewBase=${Baseline}"
                        }
                        
                    }
                }
                
                stage("Run Tests - Cert. de Bandeja de Entrada") 
                {
                    when { expression { params.Pruebas == "Cert. de Bandeja de Entrada" } }
                    steps 
                    {
                        script 
                        {
                          bat "mvn test -DsuiteXmlFiles=SuiteCertifBandejaEntrada.xml -DnewBase=${Baseline}"
                        }
                        
                    }
                }
                
                stage("Run Tests - Emitir Documentos") 
                {
                    when { expression { params.Pruebas == "Emitir Documentos" } }
                    steps 
                    {
                        script 
                        {
                          
                            bat "mvn test -DsuiteXmlFiles=SuiteEmitirDocumentos.xml -DnewBase=${Baseline}"
                        }
                    }
                }
                
                stage("Run Tests - Generar Formulario Electronico") 
                {
                    when { expression { params.Pruebas == "Generar Formulario Electronico" } }
                    steps 
                    {
                        script 
                        {
                          
                           bat "mvn test -DsuiteXmlFiles=SuiteGenerarFormularioElectronico.xml -DnewBase=${Baseline}"
                        }
                    }
                }
                
                stage("Run Tests - Portal Pagos DNPs") 
                {
                    when { expression { params.Pruebas == "Portal Pagos DNPs" } }
                    steps 
                    {
                        script 
                        {
                          
                            bat "mvn test -DsuiteXmlFiles=SuitePortalPagosDNPs.xml -DnewBase=${Baseline}"
                        }
                    }
                }
             }   
        }
    }
    
}